<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
    <title>JPAR Commission Calculator</title>
    <link rel="icon" href="https://assets.agentfire3.com/uploads/sites/16/2019/03/New-JPAR-Small.png">
    <script src="https://code.jquery.com/jquery-3.4.1.min.js"
            integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo="
            crossorigin="anonymous"></script>
    <link rel="stylesheet" href="./style.css"/>
    
</head>

<body>
    <table>
    <tbody>
     <tr>
    <td>  
    <div class="input-container">
        <h1>Residential Sale Sides</h1>
        <input type="text" id="input1" />
    </div>
    </td>
    <td>
    <div class="input-container">
        <h1>Average Sale Amount</h1>
        <input type="text" id="input2" />
    </div>
    </td>
    </tr>
    <tr>
    <td>
    <div class="input-container">
        <h1>Average Sale Commission %</h1>
        <input type="text" id="input3" />
    </div></td>
    <td>
    <div class="input-container">
        <h1>Residential Lease Sides</h1>
        <input type="text" id="input4" />
    </div></td>
    </tr>
    <tr>
    <td>
    <div class="input-container">
        <h1>Average Lease Amount</h1>
        <input type="text" id="input5" />
    </div></td>
    <td>
    <div class="input-container">
        <h1>Average Lease Commission %</h1>
        <input type="text" id="input6" />
    </div></td>
    </tr>
    <tr>
    <td>    
    <div class="output-container">
        <h1>Current Net Income</h1>
        <h1 id="out">0</h1>
    </div></td></tr>
    </tbody>
    </table>
    <br />
    <div class="input-container">
        <h1>Monthly fees to broker</h1>
        <input type="text" id="input7" />
    </div>
    <div class="input-container">
        <h1>Annual fees to broker</h1>
        <input type="text" id="input8" />
    </div>
    <div class="input-container">
        <h1>Precentage Broker Takes</h1>
        <input type="text" id="input9" />
    </div>
    <div class="input-container">
        <h1>Percentage Franchise Takes</h1>
        <input type="text" id="input10" />
    </div>
    <div class="input-container">
        <h1>Sale Transaction Fee</h1>
        <input type="text" id="input11" />
    </div>
    <div class="input-container">
        <h1>Lease Transaction Fee</h1>
        <input type="text" id="input12" />
    </div>
    <div class="input-container">
        <h1>Broker Cap</h1>
        <input type="text" id="input13" />
    </div>
    <div class="input-container">
        <h1>Sale Transaction Fee After Cap</h1>
        <input type="text" id="input14" />
    </div>
    <div class="input-container">
        <h1>Lease Transaction Fee After Cap</h1>
        <input type="text" id="input15" />
    </div>
    <div class="input-container">
        <h1>Percentage After Cap</h1>
        <input type="text" id="input16" /><br/>
    </div>

    <div class="output-container">
        <h1>Total Fees with your broker</h1>
        <h1 id="out2">0</h1>
    </div>
    <div class="output-container">
        <h1>Net with your broker</h1>
        <h1 id="out3">0</h1><br />
    </div>

    <div class="output-container">
        <h1>What fees you would pay at JPAR</h1>
        <h1 id="out4">0</h1>
    </div>
    <div class="output-container">
        <h1>What your Net Income with us</h1>
        <h1 id="out5">0</h1>
    </div>
    <div class="output-container">
        <h1> What you're saving</h1>
        <h1 id="out6">0</h1>
    </div>

    <script type="text/javascript">
    //Function for currency
    const format_money = function(num){
        let n = Number(num);
        return "$" + n.toFixed(2).replace(/\d(?=(\d{3})+\.)/g, '$&,');
    }
    const convert_percentage = function(num){
        let n = Number(num);
        return n / 100;
    }
    const format_percentage = function(num){
        return num + "%";
    }

    //input initialization
    let in1 = 0;
    let in2 = 0
    let in3 = 0;
    let in4 = 0;
    let in5 = 0;
    let in6 = 0;
    let in7 = 0;
    let in8 = 0;
    let in9 = 0;
    let in10 = 0;
    let in11 = 0;
    let in12 = 0;
    let in13 = 0;
    let in14 = 0;
    let in15 = 0;
    let in16 = 0;
        //Brokerage inputs - Annual Fee / Sale Transaction Fee / Lease Transaction Fee
        const in17 = 399;
        $('#input17').text(in17);
        const in18 = 500;
        $('#input18').text(in18);
        const in19 = 150;
        $('#input19').text(in19);
        const in20 = 12000;
        $('#input20').text(in20);

        //Input #2 auto-format
        $('#input2').change( () => {
                in1 = $('#input2').val();
                $('#input2').val(format_money(in1));
            })

        //main calculation function
        $("input").change(function () {
            let out, out2, out3, out4, out5, out6 = 0;

            //Current Net Income calc
            if (in1 !== NaN && in2 !== NaN && in3 !== NaN && in4 !== NaN && in5 !== NaN && in6 !== NaN) {
                out = ((in1*in2*in3)+(in4*in5*in6))
                $('#out').html(format_money(out));

            }
            //Total Fees with current broker calc
            if (in4 !== NaN && in7 !== NaN && in8 !== NaN && in9 !== NaN && in10 !== NaN && in11 !== NaN && in13 !==NaN){
                (out2 = (((in7*12)+in8)+Math.min(((in9*out)+(in10*out))+((in11*in1)+(in12*in4)),in13)))
                $('#out2').html(format_money(out2));
            }
            //Net with current broker calc
            if (out !== NaN && out2 !== NaN) {
                out3 = (out - out2)
                $('#out3').html(format_money(out3));
            }
            //Fees at JPAR calc
            if (in1 !== NaN && in4 !== NaN){
                out4 = (in17 + Math.min(((in1*in18) + (in4*in19)), in20))
                    $('#out4').html(format_money(out4));
            }
            //Net Income with JPAR calc
            if (out4 !== NaN && out !== NaN) {
                out5 = (out4 - out)
                $('#out5').html(format_money(out5));
            }
            //Savings calc
            if(out4 !== NaN && out2 !== NaN){
                out6 = (out2 - out4)
                $('#out6').html(format_money(out6));
            }
            
    })
    </script>
</body>

</html>