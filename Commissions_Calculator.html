<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
    <title>JPAR Commission Calculator</title>
    <link rel="icon" href="https://assets.agentfire3.com/uploads/sites/16/2019/03/New-JPAR-Small.png">
    <script src="https://code.jquery.com/jquery-3.4.1.min.js"
            integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo="            crossorigin="anonymous">
    </script>
    <link href='https://fonts.googleapis.com/css?family=Roboto' rel='stylesheet'>
    <link href='https://fonts.googleapis.com/css?family=Montserrat' rel='stylesheet'>
    
    <link rel="stylesheet" href="./style.css"/>
    
</head>

<body>

    <header class="header">
        <table align= "center">
            <tr>
                <th>
                    <image src = "https://assets.agentfire3.com/uploads/sites/82/2019/07/JPAR-Logo-Come-Grow-with-Us.png" alt = "Jpar logo" style="height:100px; background: white; margin-right: 15px; padding: 4px"/>
                </th>
                <th>
                    <h1> Commission Calculator</h1>
                    <h3> Place your numbers to see your income, and compare! </h3>
                </th>
            </tr>
        </table>
    </header>

    <div class="input-container">
        <label>Residential Sale Sides</label>
        <input type="text" id="input1" />
    </div>

    <div class="input-container">
        <label>Average Sale Amount</label>
        <input type="text" id="input2" />
    </div>
    <div class="input-container">
        <label>Average Sale Commission %</label>
        <input type="text" id="input3" />
    </div>
    <div class="input-container">
        <label>Residential Lease Sides</label>
        <input type="text" id="input4" />
    </div>
    <div class="input-container">
        <label>Average Lease Amount</label>
        <input type="text" id="input5" />
    </div>
    <div class="input-container">
        <label>Average Lease Commission %</label>
        <input type="text" id="input6" />
    </div>
    <div class="output-container">
        <label>Current Net Income</label>
        <label id="out">0</label><br />
    </div>

    <div class="input-container">
        <label>Monthly fees to broker</label>
        <input type="text" id="input7" />
    </div>
    <div class="input-container">
        <label>Annual fees to broker</label>
        <input type="text" id="input8" />
    </div>
    <div class="input-container">
        <label>Precentage Broker Takes</label>
        <input type="text" id="input9" />
    </div>
    <div class="input-container">
        <label>Percentage Franchise Takes</label>
        <input type="text" id="input10" />
    </div>
    <div class="input-container">
        <label>Sale Transaction Fee</label>
        <input type="text" id="input11" />
    </div>
    <div class="input-container">
        <label>Lease Transaction Fee</label>
        <input type="text" id="input12" />
    </div>
    <div class="input-container">
        <label>Broker Cap</label>
        <input type="text" id="input13" />
    </div>
    <div class="input-container">
        <label>Sale Transaction Fee After Cap</label>
        <input type="text" id="input14" />
    </div>
    <div class="input-container">
        <label>Lease Transaction Fee After Cap</label>
        <input type="text" id="input15" />
    </div>
    <div class="input-container">
        <label>Percentage After Cap</label>
        <input type="text" id="input16" /><br/>
    </div>

    <div class="output-container">
        <label>Total Fees with your broker</label>
        <label id="out2">0</label>
    </div>
    <div class="output-container">
        <label>Net with your broker</label>
        <label id="out3">0</label><br />
    </div>

    <div class="output-container">
        <label>What fees you would pay at JPAR</label>
        <label id="out4">0</label>
    </div>
    <div class="output-container">
        <label>What your Net Income with us</label>
        <label id="out5">0</label>
    </div>
    <div class="output-container">
        <label> What you're saving</label>
        <label id="out6">0</label>
    </div>

    <script type="text/javascript">
    //Function for currency
    const format_money = function(num){
        let n = Number(num);
        return "$" + n.toFixed(2).replace(/\d(?=(\d{3})+\.)/g, '$&,');
    }
    const convert_percentage = function(num){
        let n = Number(num);
        return n / 100;
    }
    const format_percentage = function(num){
        return num + "%";
    }

    const cleanup = function(num){
        num = num.replace(',', '');
        num = num.replace('$', '');
        num = num.replace('%', '');
        num = Number(num);
        return num;
    }

    const read = function(id){
        return cleanup($(id).val());
    }

    //input initialization
    let in1 = 0;
    let in2 = 0
    let in3 = 0;
    let in4 = 0;
    let in5 = 0;
    let in6 = 0;
    let in7 = 0;
    let in8 = 0;
    let in9 = 0;
    let in10 = 0;
    let in11 = 0;
    let in12 = 0;
    let in13 = 0;
    let in14 = 0;
    let in15 = 0;
    let in16 = 0;
        //Brokerage inputs - Annual Fee / Sale Transaction Fee / Lease Transaction Fee
        const in17 = 399;
        //$('#input17').text(in17);
        const in18 = 500;
        //$('#input18').text(in18);
        const in19 = 150;
        //$('#input19').text(in19);
        const in20 = 12000;
        //$('#input20').text(in20);
        
        //Input processing
        $('#input1').change( () => {
            in1 = read('#input1');
        })

        $('#input2').change( () => {
            in2 = read('#input2');
            $('#input2').val(format_money(in2));
        })

        $('#input3').change( () => {
            let tmp = read('#input3');
            in3 = convert_percentage(tmp);
            $('#input3').val(format_percentage(tmp));
        })

        $('#input4').change( () => {
            in4 = read('#input4');
        })

        $('#input5').change( () => {
            in5 = read('#input5');
            $('#input5').val(format_money(in5));
        })

        $('#input6').change( () => {
            let tmp = read('#input6');
            in6 = convert_percentage(tmp);
            $('#input6').val(format_percentage(tmp));
        })

        //monthly fees to broker
        $('#input7').change( () => {
            in7 = read('#input7');
            $('#input7').val(format_money(in7));
        })

        //annual fees to broker
        $('#input8').change( () => {
            in8 = read('#input8');
            $('#input8').val(format_money(in8));
        })

        //percentage broker
        $('#input9').change( () => {
            let tmp = read('#input9');
            in9 = convert_percentage(tmp);
            $('#input9').val(format_percentage(tmp));
        })

        //percentage franchise
        $('#input10').change( () => {
            let tmp = read('#input10');
            in10 = convert_percentage(tmp);
            $('#input10').val(format_percentage(tmp));
        })

        //sales transaction fee
        $('#input11').change( () => {
            in11 = read('#input11');
            $('#input11').val(format_money(in11));
        })

        //lease transaction fee
        $('#input12').change( () => {
            in12 = read('#input12');
            $('#input12').val(format_money(in12));
        })

        $('#input13').change( () => {
            in13 = read('#input13');
            $('#input13').val(format_money(in13));
        })

        $('#input14').change( () => {
            in14 = read('#input14');
            $('#input14').val(format_money(in14));
        })

        $('#input15').change( () => {
            in15 = read('#input15');
            $('#input15').val(format_money(in15));
        })

        $('#input16').change( () => {
            let tmp = read('#input16');
            in16 = convert_percentage(tmp);
            $('#input16').val(format_percentage(tmp));
        })

        //main calculation function
        $("input").change(function () {
            let out, out2, out3, out4, out5, out6 = 0;

            //Current Net Income calc
            if (in1 !== NaN && in2 !== NaN && in3 !== NaN && in4 !== NaN && in5 !== NaN && in6 !== NaN) {
                out = ((in1*in2*in3)+(in4*in5*in6))
                $('#out').html(format_money(out));

            }
            //Total Fees with current broker calc
            if (in4 !== NaN && in7 !== NaN && in8 !== NaN && in9 !== NaN && in10 !== NaN && in11 !== NaN && in13 !==NaN){
                (out2 = (((in7*12)+in8)+Math.min(((in9*out)+(in10*out))+((in11*in1)+(in12*in4)),in13)))
                $('#out2').html(format_money(out2));
            }
            //Net with current broker calc
            if (out !== NaN && out2 !== NaN) {
                out3 = (out - out2)
                $('#out3').html(format_money(out3));
            }
            //Fees at JPAR calc
            if (in1 !== NaN && in4 !== NaN){
                out4 = (in17 + Math.min(((in1*in18) + (in4*in19)), in20))
                    $('#out4').html(format_money(out4));
            }
            //Net Income with JPAR calc
            if (out4 !== NaN && out !== NaN) {
                out5 = (out-out4)
                $('#out5').html(format_money(out5));
            }
            //Savings calc
            if(out4 !== NaN && out2 !== NaN){
                out6 = (out2 - out4)
                $('#out6').html(format_money(out6));
            }
            
    })
    </script>
</body>

</html>